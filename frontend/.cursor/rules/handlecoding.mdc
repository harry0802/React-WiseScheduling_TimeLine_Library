---
description: handle project  comply with  customers in principle
globs: 
alwaysApply: false
---
# AI 程式碼生成指南

在生成任何程式碼時，請遵循以下原則，以確保低認知負荷和高可維護性：

## 1. 代碼生成原則

### 基本要求
- 每個函數只做一件事
- 函數名稱要能完整描述其功能
- 變數名稱要有意義且自解釋
- 巢狀層級不超過 3 層
- 單個函數不超過 30 行
- 條件判斷要清晰易讀

### 認知負荷控制
- 任何時候需要同時理解的概念不超過 4 個
- 複雜邏輯必須拆分成小函數
- 使用早期返回避免深層巢狀
- 重要邏輯必須有註釋說明
- 業務規則要抽象成具名常數或配置

### 代碼組織
- 相關的功能要組織在一起
- 使用組合優於繼承
- 介面要簡單，實現可以複雜
- 避免過度工程化
- 優先考慮可讀性和可維護性

## 2. 回應格式要求

每次生成代碼時，請包含：

1. 代碼結構說明
2. 關鍵設計決策解釋
3. 使用示例
4. 可能需要注意的維護點

## 3. 特殊標記說明

在生成的代碼中使用以下標記：

🧠 - 需要特別注意理解的部分
💡 - 重要的設計決策說明
⚠️ - 潛在的維護風險點
✨ - 優化或簡化的部分

## 4. 代碼模式偏好

### 優先使用
- 直接了當的解決方案
- 標準庫功能
- 普遍使用的設計模式
- 容易測試的結構

### 避免使用
- 過度抽象
- 不必要的設計模式
- 難以理解的技巧
- 過於花哨的特性

## 5. 維護性考慮

生成代碼時考慮：
1. 新手開發者的理解難度
2. 未來的擴展可能性
3. 測試的便利性
4. 文檔的完整性

## 代碼評估標準

每段生成的代碼都應該：

1. 容易理解 - 新手能快速掌握
2. 容易修改 - 改動影響可控
3. 容易測試 - 邊界清晰
4. 容易擴展 - 結構靈活

## 示例響應格式

當收到代碼請求時：

1. 先理解需求的核心目標
2. 設計最簡單可行的方案
3. 生成符合上述原則的代碼
4. 提供使用說明和注意事項

---

使用此模板評估代碼請求：

1. 需求理解
   - 核心功能是什麼？
   - 有什麼限制條件？
   - 可能的擴展需求？

2. 方案設計
   - 最簡單的實現方式？
   - 需要考慮的邊界情況？
   - 可能的維護挑戰？

3. 代碼生成
   - 是否符合認知負荷原則？
   - 是否容易理解和維護？
   - 是否考慮到了擴展性？

4. 補充說明
   - 使用示例
   - 注意事項
   - 維護建議


# React useEffect 代碼生成指南

## 目標與範圍

本指南旨在規範React useEffect相關代碼的生成,確保代碼符合最佳實踐並具備良好的可維護性。

## 基本要求

### 代碼規範優先級
1. 正確性與可靠性
2. 性能表現
3. 可維護性
4. 代碼簡潔度

### 代碼品質標準
- 清晰的邏輯結構
- 完整的錯誤處理
- 充分的代碼註釋
- 合適的模塊化程度

## 技術規範

### JavaScript 基礎規範
- 使用現代ES6+語法
- 遵循React 18+最佳實踐
- 符合ESLint標準配置
- 保持代碼簡潔可讀

### TypeScript 增強規範 (可選)
當使用TypeScript時:
- 啟用嚴格模式檢查
- 提供完整的類型定義
- 避免使用any類型
- 利用TypeScript的高級特性

## 核心場景處理

### 1. 異步請求處理
```javascript
// ✅ 推薦實現
useEffect(() => {
  let ignore = false;
  
  async function fetchData() {
    try {
      const result = await api.getData();
      if (!ignore) {
        setData(result);
      }
    } catch (error) {
      // 錯誤處理
    }
  }
  
  fetchData();
  return () => {
    ignore = true;
  };
}, [dependencies]);

// ❌ 避免的實現
useEffect(() => {
  fetchData().then(setData);
}, []);
```

### 2. 父子組件數據流
```javascript
// ✅ 推薦實現
function Parent() {
  const handleChange = useCallback((value) => {
    // 直接在事件處理中更新
  }, []);
  
  return <Child onChange={handleChange} />;
}

// ❌ 避免的實現
function Child({ onChange }) {
  useEffect(() => {
    onChange(value);
  }, [value]);
}
```

### 3. 初始化處理
```javascript
// ✅ 推薦實現
let initialized = false;

function App() {
  useEffect(() => {
    if (!initialized) {
      initialized = true;
      // 初始化邏輯
    }
  }, []);
}

// ❌ 避免的實現
function App() {
  useEffect(() => {
    // 直接初始化
  }, []);
}
```

## 最佳實踐檢查清單

### 基礎檢查
- [ ] 所有異步操作都有清理機制
- [ ] 正確處理組件卸載情況
- [ ] 適當處理錯誤情況
- [ ] 避免不必要的依賴

### 性能檢查
- [ ] 避免過度渲染
- [ ] 正確使用依賴數組
- [ ] 合理使用記憶化
- [ ] 優化異步操作

### 維護性檢查
- [ ] 清晰的代碼結構
- [ ] 完整的註釋說明
- [ ] 合理的代碼分割
- [ ] 一致的代碼風格

## 替代方案建議

根據具體場景,可選擇:
1. 數據獲取：任何合適的請求管理方案
2. 狀態管理：根據項目規模選擇
3. 表單處理：項目實際需求為準

## 代碼生成模板

```javascript
// 場景描述：[描述具體需求]

// 推薦實現
function RecommendedComponent() {
  // 實現代碼
  
  // 使用說明
  // 1. [功能說明]
  // 2. [實現要點]
  // 3. [注意事項]
}

// 避免的實現
function AntiPatternExample() {
  // 反模式示例
  
  // 問題說明
  // 1. [存在的問題]
  // 2. [影響]
  // 3. [改進建議]
}
```

## 驗證標準

基礎要求:
- 代碼可執行性
- 邏輯完整性
- 錯誤處理
- React規範遵守

TypeScript額外要求(當使用TS時):
- 類型完整性
- 嚴格模式兼容
- 類型安全性
- 介面定義清晰

## 注意事項

4. 保持靈活性
   - 根據實際需求選擇適當的實現方案
   - 避免過度設計
   - 關注代碼實用性

5. 代碼質量
   - 確保可維護性
   - 重視代碼復用
   - 注重性能優化

6. 最佳實踐
   - 遵循React官方建議
   - 保持代碼簡潔
   - 優先考慮用戶體驗

本指南注重實用性和靈活性,在保證代碼質量的同時允許根據具體場景做出調整。



# CSS 樣式開發規範 Prompt 模板 v1.0

您正在使用一個整合 BBC 編碼標準與現代 CSS 架構的開發規範系統。請嚴格遵循以下規範進行樣式開發：

## 【強制性規範】

1. **屬性排序**
```
布局定位: display/position/float/flex/grid
盒模型: width/height→padding→margin→box-sizing
視覺樣式: background→color→font→text
CSS3特效: transform→transition→animation→filter
其他屬性: cursor/overflow/z-index
```

2. **BBC標準**
```
- 命名：BEM + kebab-case
- 選擇器：巢狀 ≤ 3級，禁用ID與!important
- 顏色：RGBA百分比 (rgba(100% 100% 100% / 0.8))
```

1. **響應式準則**
```
- 移動優先
- 斷點變量化 ($breakpoint-md: 768px)
- 單位優先級：rem > % > px
```

2. **性能要求**
```
- 複合屬性必須拆分
- transform/opacity 獨立圖層
- CSS變量分層 (:root→組件)
```

## 【組件實現規範】

輸入結構：
```jsx
<MachineBox status="active">
  <div className="title-container">{title}</div>
  <div className="status-container">
    <span>{statusText}</span>
    <Icon className="icon" />
  </div>
</MachineBox>
```

功能要求：
```
3. 動態背景色對應狀態 (active/warning/error)
4. 桌面端懸停邊框動畫
5. 移動端最小點擊區域 44px
6. 必須支援 aria-live
```

## 【代碼輸出規範】

請使用 TypeScript 與 styled-components 實現以下分層：
```
7. 基礎布局層
8. 狀態邏輯層
9. 響應式層
10. 動效處理層 (createGlobalStyle)
```

必須包含：
- 完整 JSDoc 類型註釋
- BBC 標準合規性標記
- 性能優化證明

---

提示：本規範強制執行分層架構、BBC標準、性能優化與無障礙設計。違反核心規範的代碼將被視為不合格。


請扮演一位資深的 JavaScript 程式碼管理專家,以照顧初級開發者的角度來重組這份不超過 800 行的程式碼。請依照 Airbnb 風格指南並按以下步驟處理:

1. 程式碼概況分析
- 統計程式碼行數
- 標記複雜度較高的部分
- 檢查 Airbnb 規範符合度

2. 結構化分層
//! =============== 1. 設定與常量 ===============
//* 這個區塊包含所有專案配置,便於統一管理
- 環境配置
- 常量定義
- API 端點

//! =============== 2. 類型與介面 ===============
//* 定義所有資料結構,幫助理解資料流向
- 資料模型
- 介面定義

//! =============== 3. 核心功能 ===============
//* 主要業務邏輯區,每個功能都配有詳細說明
- 主要業務邏輯
- 狀態處理
- API 請求

//! =============== 4. 工具函數 ===============
//* 通用功能區,可被多個模組復用
- 通用工具方法
- 資料轉換函數

1. 詳細註解指南
/** 
 * @function [函數名稱]
 * @description [詳細的功能解釋,包含使用場景]
 * @param {類型} 參數名 - 詳細的參數用途說明
 * @returns {類型} - 詳細的返回值說明
 * @example 
 * // 基礎使用示例
 * const result = functionName(params);
 * 
 * @notes 
 * - 重要提醒事項
 * - 可能的陷阱
 * - 效能考量
 * 
 * @commonErrors
 * - 常見錯誤1及解決方案
 * - 常見錯誤2及解決方案
 */

使用 Better Comments 進行分類:
//! 重要警告或核心功能 (必須特別注意的部分)
//* 詳細的功能說明 (幫助理解的關鍵資訊)
//? 需要團隊討論或可能變動的部分
//TODO 待優化或後續要處理的項目
// 一般說明性註解

2. 複雜邏輯說明區
//* ========= 複雜邏輯解釋 =========
// 步驟 1: [具體做了什麼]
// 步驟 2: [為什麼這樣做]
// 步驟 3: [注意事項]

3. 程式碼範例區 (註解狀態)
//! =============== 示例區塊 ===============
/**
 * @example 常見使用場景
 * // 場景 1: 基本使用
 * // 場景 2: 錯誤處理
 * // 場景 3: 特殊案例
 */
 


